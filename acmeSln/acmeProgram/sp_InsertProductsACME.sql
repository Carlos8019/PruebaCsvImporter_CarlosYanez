-- Create a new stored procedure called 'sp_InsertProductsACME' in schema 'dbo'
-- Drop the stored procedure if it already exists
IF EXISTS (
SELECT *
    FROM INFORMATION_SCHEMA.ROUTINES
WHERE SPECIFIC_SCHEMA = N'dbo'
    AND SPECIFIC_NAME = N'sp_InsertProductsACME'
)
BEGIN
DROP PROCEDURE dbo.sp_InsertProductsACME
END
GO
-- Create the stored procedure in the specified schema
CREATE PROCEDURE dbo.sp_InsertProductsACME
    @json nvarchar(MAX) ,
    @response VARCHAR(50) OUT
AS
    --set @response=0;
    -- body of the stored procedure
   
    begin TRY
     BEGIN TRAN
        insert into dbo.tblProductsACME
        (pointOfSale,product,dateValue,stock )
        SELECT pointOfSale,product,dateValue,stock
        FROM OPENJSON(@json)
        WITH (
            pointOfSale NVARCHAR(50) '$.pointOfSale',
            product NVARCHAR(50) '$.product',
            dateValue NVARCHAR(50) '$.date',
            stock NVARCHAR(50) '$.stock'
        )
    COMMIT TRAN
    set @response=1
    end TRY
    begin CATCH
        IF(@@TRANCOUNT>0)
        begin 
            ROLLBACK TRAN    
        end
        INSERT tblErrorInsertACME(jsonRawData,dateInsert)
        select @json,getdate()

        set @response=0--ERROR_MESSAGE()

    END CATCH
    
GO
/*
truncate table dbo.tblProductsACME
-- example to execute the stored procedure we just created
EXECUTE dbo.sp_InsertProductsACME '[{"pointOfSale":"121017","product":"17240503103734","date":"2019-08-17","stock":"2"},{"pointOfSale":"121017","product":"17240503103734","date":"2019-08-18","stock":"2"},{"pointOfSale":"121017","product":"17240503103734","date":"2019-08-19","stock":"2"},{"pointOfSale":"121017","product":"17240503103734","date":"2019-08-20","stock":"2"},{"pointOfSale":"121017","product":"17240503103734","date":"2019-08-21","stock":"2"},{"pointOfSale":"121017","product":"17240503103734","date":"2019-08-22","stock":"2"},{"pointOfSale":"121017","product":"17240503103734","date":"2019-07-27","stock":"1"},{"pointOfSale":"121017","product":"17240503103734","date":"2019-07-28","stock":"1"},{"pointOfSale":"121017","product":"17240503103734","date":"2019-07-29","stock":"1"},{"pointOfSale":"121017","product":"17240503103734","date":"2019-07-30","stock":"1"},{"pointOfSale":"121017","product":"17240503103734","date":"2019-07-31","stock":"1"},{"pointOfSale":"121017","product":"17240503103734","date":"2019-08-01","stock":"1"},{"pointOfSale":"121017","product":"17240503103734","date":"2019-08-02","stock":"1"},{"pointOfSale":"121017","product":"17240503103734","date":"2019-08-03","stock":"1"},{"pointOfSale":"121017","product":"17240503103734","date":"2019-08-04","stock":"1"},{"pointOfSale":"121017","product":"17240503103734","date":"2019-08-05","stock":"1"},{"pointOfSale":"121017","product":"17240503103734","date":"2019-08-06","stock":"1"},{"pointOfSale":"121017","product":"17240503103734","date":"2019-08-07","stock":"1"},{"pointOfSale":"121017","product":"17240503103734","date":"2019-08-08","stock":"1"},{"pointOfSale":"121017","product":"17240503103734","date":"2019-08-09","stock":"1"},{"pointOfSale":"121017","product":"17240503103734","date":"2019-08-10","stock":"1"},{"pointOfSale":"121017","product":"17240503103734","date":"2019-08-11","stock":"1"},{"pointOfSale":"121017","product":"17240503103734","date":"2019-08-12","stock":"1"},{"pointOfSale":"121017","product":"17240503103734","date":"2019-08-13","stock":"1"},{"pointOfSale":"121017","product":"17240503103734","date":"2019-08-14","stock":"1"},{"pointOfSale":"121017","product":"17240503103734","date":"2019-08-15","stock":"1"},{"pointOfSale":"121017","product":"17240503103734","date":"2019-08-16","stock":"1"},{"pointOfSale":"121017","product":"17240503103738","date":"2019-08-17","stock":"1"},{"pointOfSale":"121017","product":"17240503103738","date":"2019-08-18","stock":"1"},{"pointOfSale":"121017","product":"17240503103738","date":"2019-08-19","stock":"1"},{"pointOfSale":"121017","product":"17240503103738","date":"2019-08-20","stock":"1"},{"pointOfSale":"121017","product":"17240503103738","date":"2019-08-21","stock":"1"},{"pointOfSale":"121017","product":"17240503103738","date":"2019-08-22","stock":"1"},{"pointOfSale":"121017","product":"17240503103738","date":"2019-07-27","stock":"1"},{"pointOfSale":"121017","product":"17240503103738","date":"2019-07-28","stock":"1"},{"pointOfSale":"121017","product":"17240503103738","date":"2019-07-29","stock":"1"},{"pointOfSale":"121017","product":"17240503103738","date":"2019-07-30","stock":"1"},{"pointOfSale":"121017","product":"17240503103738","date":"2019-07-31","stock":"1"},{"pointOfSale":"121017","product":"17240503103738","date":"2019-08-01","stock":"1"},{"pointOfSale":"121017","product":"17240503103738","date":"2019-08-02","stock":"1"},{"pointOfSale":"121017","product":"17240503103738","date":"2019-08-03","stock":"1"},{"pointOfSale":"121017","product":"17240503103738","date":"2019-08-04","stock":"1"},{"pointOfSale":"121017","product":"17240503103738","date":"2019-08-05","stock":"1"},{"pointOfSale":"121017","product":"17240503103738","date":"2019-08-06","stock":"1"},{"pointOfSale":"121017","product":"17240503103738","date":"2019-08-07","stock":"1"},{"pointOfSale":"121017","product":"17240503103738","date":"2019-08-08","stock":"1"},{"pointOfSale":"121017","product":"17240503103738","date":"2019-08-09","stock":"1"},{"pointOfSale":"121017","product":"17240503103738","date":"2019-08-10","stock":"1"},{"pointOfSale":"121017","product":"17240503103738","date":"2019-08-11","stock":"1"},{"pointOfSale":"121017","product":"17240503103738","date":"2019-08-12","stock":"1"},{"pointOfSale":"121017","product":"17240503103738","date":"2019-08-13","stock":"1"},{"pointOfSale":"121017","product":"17240503103738","date":"2019-08-14","stock":"1"},{"pointOfSale":"121017","product":"17240503103738","date":"2019-08-15","stock":"1"},{"pointOfSale":"121017","product":"17240503103738","date":"2019-08-16","stock":"1"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-07-03","stock":"2"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-08-17","stock":"4"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-08-18","stock":"4"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-08-19","stock":"4"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-08-20","stock":"4"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-08-21","stock":"4"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-08-22","stock":"4"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-07-27","stock":"4"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-07-28","stock":"4"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-07-29","stock":"4"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-07-30","stock":"4"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-07-31","stock":"4"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-08-01","stock":"4"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-08-02","stock":"4"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-08-03","stock":"4"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-08-04","stock":"4"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-08-05","stock":"4"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-08-06","stock":"4"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-08-07","stock":"4"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-08-08","stock":"4"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-08-09","stock":"4"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-08-10","stock":"4"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-08-11","stock":"4"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-08-12","stock":"4"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-08-13","stock":"4"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-08-14","stock":"4"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-08-15","stock":"4"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-08-16","stock":"4"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-07-23","stock":"4"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-07-24","stock":"4"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-07-25","stock":"4"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-07-26","stock":"4"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-06-28","stock":"2"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-06-29","stock":"2"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-06-30","stock":"2"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-07-01","stock":"2"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-07-02","stock":"2"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-07-04","stock":"2"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-07-05","stock":"2"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-07-06","stock":"2"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-07-07","stock":"2"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-07-08","stock":"2"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-07-09","stock":"2"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-07-10","stock":"2"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-07-11","stock":"2"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-07-12","stock":"2"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-07-13","stock":"2"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-07-14","stock":"2"}
,{"pointOfSale":"1210\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u000017","product":"17240503200794","date":"2019-07-15","stock":"2"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-07-16","stock":"2"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-07-17","stock":"2"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-07-18","stock":"2"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-07-19","stock":"2"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-07-20","stock":"2"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-07-21","stock":"2"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-07-22","stock":"2"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-06-01","stock":"1"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-06-02","stock":"1"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-06-03","stock":"1"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-06-04","stock":"1"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-06-05","stock":"1"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-06-06","stock":"1"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-06-07","stock":"1"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-06-08","stock":"1"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-06-09","stock":"1"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-06-10","stock":"1"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-06-11","stock":"1"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-06-12","stock":"1"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-06-13","stock":"1"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-06-14","stock":"1"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-06-15","stock":"1"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-06-16","stock":"1"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-06-17","stock":"1"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-06-18","stock":"1"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-06-19","stock":"1"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-06-20","stock":"1"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-06-21","stock":"1"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-06-22","stock":"1"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-06-23","stock":"1"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-06-24","stock":"1"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-06-25","stock":"1"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-06-26","stock":"1"},{"pointOfSale":"121017","product":"17240503200794","date":"2019-06-27","stock":"1"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-07-03","stock":"3"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-08-17","stock":"4"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-08-18","stock":"4"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-08-19","stock":"4"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-08-20","stock":"4"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-08-21","stock":"4"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-08-22","stock":"4"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-07-27","stock":"4"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-07-28","stock":"4"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-07-29","stock":"4"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-07-30","stock":"4"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-07-31","stock":"4"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-08-01","stock":"4"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-08-02","stock":"4"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-08-03","stock":"4"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-08-04","stock":"4"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-08-05","stock":"4"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-08-06","stock":"4"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-08-07","stock":"4"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-08-08","stock":"4"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-08-09","stock":"4"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-08-10","stock":"4"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-08-11","stock":"4"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-08-12","stock":"4"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-08-13","stock":"4"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-08-14","stock":"4"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-08-15","stock":"4"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-08-16","stock":"4"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-07-23","stock":"5"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-07-24","stock":"5"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-07-25","stock":"5"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-07-26","stock":"5"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-06-28","stock":"3"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-06-29","stock":"3"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-06-30","stock":"3"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-07-01","stock":"3"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-07-02","stock":"3"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-07-04","stock":"3"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-07-05","stock":"3"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-07-06","stock":"3"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-07-07","stock":"3"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-07-08","stock":"3"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-07-09","stock":"3"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-07-10","stock":"3"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-07-11","stock":"3"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-07-12","stock":"3"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-07-13","stock":"3"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-07-14","stock":"3"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-07-15","stock":"3"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-07-16","stock":"3"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-07-17","stock":"3"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-07-18","stock":"3"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-07-19","stock":"3"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-07-20","stock":"3"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-07-21","stock":"3"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-07-22","stock":"4"}
,{"pointOfSale":"121017","product":"17240503200796","date":"2019-06-01","stock":"3"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-06-02","stock":"3"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-06-03","stock":"3"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-06-04","stock":"3"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-06-05","stock":"3"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-06-06","stock":"3"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-06-07","stock":"3"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-06-08","stock":"3"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-06-09","stock":"3"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-06-10","stock":"3"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-06-11","stock":"3"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-06-12","stock":"3"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-06-13","stock":"3"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-06-14","stock":"3"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-06-15","stock":"3"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-06-16","stock":"3"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-06-17","stock":"3"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-06-18","stock":"3"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-06-19","stock":"3"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-06-20","stock":"3"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-06-21","stock":"3"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-06-22","stock":"3"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-06-23","stock":"3"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-06-24","stock":"3"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-06-25","stock":"3"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-06-26","stock":"3"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-06-27","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-07-03","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-08-17","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-08-18","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-08-19","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-08-20","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-08-21","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-08-22","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-07-27","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-07-28","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-07-29","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-07-30","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-07-31","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-08-01","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-08-02","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-08-03","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-08-04","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-08-05","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-08-06","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-08-07","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-08-08","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-08-09","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-08-10","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-08-11","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-08-12","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-08-13","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-08-14","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-08-15","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-08-16","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-07-23","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-07-24","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-07-25","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-07-26","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-06-28","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-06-29","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-06-30","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-07-01","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-07-02","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-07-04","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-07-05","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-07-06","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-07-07","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-07-08","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-07-09","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-07-10","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-07-11","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-07-12","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-07-13","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-07-14","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-07-15","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-07-16","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-07-17","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-07-18","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-07-19","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-07-20","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-07-21","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-07-22","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-06-01","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-06-02","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-06-03","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-06-04","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-06-05","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-06-06","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-06-07","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-06-08","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-06-09","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-06-10","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-06-11","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-06-12","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-06-13","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-06-14","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-06-15","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-06-16","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-06-17","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-06-18","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-06-19","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-06-20","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-06-21","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-06-22","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-06-23","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-06-24","stock":"3"},{"pointOfSale":"121017","product":"17240503300796","date":"2019-06-25","stock":"3"}]' 
, ''

SELECT pointOfSale,product,dateValue,stock
        FROM OPENJSON('[{"pointOfSale":"121017","product":"17240503200796","date":"2019-06-02","stock":"3"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-06-03","stock":"3"}')
        WITH (
            pointOfSale NVARCHAR(50) '$.pointOfSale',
            product NVARCHAR(50) '$.product',
            dateValue NVARCHAR(50) '$.date',
            stock NVARCHAR(50) '$.stock'
        )

EXECUTE dbo.sp_InsertProductsACME
'[{"pointOfSale":"121017","product":"17240503200796","date":"2019-06-02","stock":"3"},{"pointOfSale":"121017","product":"17240503200796","date":"2019-06-03","stock":"3"}',''
--GO
select count(1) from  dbo.tblProductsACME with (nolock)
select * from dbo.tblProductsACME
select * from dbo.tblErrorInsertACME
DBCC SHRINKFILE (N'ACMEDB_log' , 0, TRUNCATEONLY)
*/